BZF archive

start with "(c) 2001 by JoWooD Productions Software AG\n"  
then "bbzf"  
then unsigned int - date  
then unsigned int - file num  

then encrypted data 54 * file num.   

For encoding data - loop xor with key 
'\x8b','\xc2','\x69','\x80','\x46','\x42','\x18','\x25','\x80','\x5d','\xaa','\x02','\x6d','\x49','\x11','\x94','\xa8','\x01','\xe7','\x58','\xcb','\x8d','\xa6','\x30','\x3e','\x83','\x1b','\x09','\x4c','\xce','\x18','\xbb','\x7c','\xae','\x6a','\x30','\x1e','\x00','\x0a','\xc9','\x24','\xc0','\x98','\xfd','\x33','\xcc','\x04','\x44','\xfa','\xea','\x8f','\x33','\xc3','\x0d','\xf2','\xe8','\x47','\xd4','\xdc','\xa8','\xc7','\x54','\xa2','\xc7','\x58','\x17','\x32','\xc8','\x7f','\x64','\x4a','\xc6','\xfd','\xc1','\xe7','\x13','\xec','\xb7','\xff','\x1e','\x0b','\xd5','\x72','\x9a','\x57','\xf8','\x3f','\xdc','\xdb','\xc9','\xf3','\x85','\xc8','\x86','\x68','\x62','\xc8','\x06','\xab','\x90','\x90','\xf7','\x3e','\xe4','\xb4','\x6b','\x80','\x89','\xc0','\x93','\x69','\xeb','\x84','\xc9','\x7a','\xd4','\xaf','\xd4','\xf4','\xd5','\xa0','\x68','\x49','\xe8','\x78','\xed','\xd0','\x53','\x74','\x81','\xbc','\xd0','\x7a','\x40','\x4f','\xea','\xf1','\xc3','\x4b','\xaa','\xd6','\xe6','\xaa','\x73','\x0c','\xcf','\x8e','\x2b','\xf4','\x2c','\x7b','\x9b','\x3e','\xbb','\xc4','\x19','\xff','\x10','\x43','\x64','\x03','\x93','\x4d','\xcf','\x64','\xc8','\xe5','\xa2','\x5b','\xd3','\x30','\xbd','\x57','\x3b','\x2a','\x7e','\x4c','\xee','\x96','\xe5','\x4e','\x85','\x3b','\xf6','\x5e','\xca','\x4d','\x5f','\x84','\x77','\x2a','\x5b','\x1e','\x41','\x47','\xd6','\x77','\x15','\x69','\xd2','\x9b','\xa2','\x18','\x09','\x6a','\x17','\x50','\xd4','\xec','\x2e','\x7b','\x4b','\xe4','\x69','\x9c','\xae','\xa8','\x9b','\xcd','\x04','\x2f','\xab','\xeb','\x01','\x6c','\x95','\x90','\x2d','\xda','\xb1','\x41','\x43','\x59','\x38','\xe9','\xd7','\x38','\x04','\x86','\x3c','\x93','\x97','\x23','\xa5','\xdf','\x5f','\x06','\x8a','\xc3','\x39','\x2a','\x4e','\x29','\x33','\xf0','\x1e'

For each file:  
char - type of data (0 - non coded data, 1 - coded zlib 6 level)  
uint - offset from begin to file data  
uint - encoded data size  
uint - coded data size  
char[40] - name of file (non case sensitive)  


.npf файлы - подсказки штурмана  

сначала идут 2 ushort (скорей всего размер и что-то еще). Потом ushort - количество объектов  
Потом 3 float - непонятно что

Состоит из объектов, на каждый объект вроде как 16 байт.  
Первые 4 байта - uint - тип подсказки  
Следующие 12 байт - вроде как 3 флота - координаты  

Типы подсказок:  
0 - левый 1  
1 - левый 2  
2 - левый 3  
3 - левый 4  
4 - левый 5  
5 - слева крутой поворот  
6 - слева поворот  
7 - правый 1  
8 - правый 2  
9 - правый 3  
10 - правый 4  
11 - правый 5  
12 - справа крутой поворот  
13 - справа поворот  
14 - сужение  
15 - расширение  
16 - прямо  
17 - осторожно  
18 - осторожно - мост  
19 - осторожно - тунель  
20 - прыжок  
21 - может быть прыжок  
22 - внимание  
23 - внимание - камни  
24 - внимание - канава  
25 - внимание - бревна  
26 - внимание - пост  
27 - не срезать  
28 - не срезать - камни  
29 - не срезать - канава  
30 - не срезать - бревна  
31 - не срезать - пост  
32 - 3, 2, 1, пошёл!  
33 - финиш  
34 - у тебя что, отвалилась педаль газа?  
35 - как ты вообще права получил?  



.spf - вроде как описание объектов на трассе  

сначала идут 2 ushort (скорей всего размер и что-то еще). Потом ushort - количество объектов  
Потом 3 float - непонятно что  

Затем идут объекты. Описание объекта начинается ushort - тип объекта, после чего взависимости от типа объекта идут его данные (обычно это 3 float - координаты объекта)


Трэки

Трэки находятся в папке Data/Tracks/trackN, где N - номер трэка  
В каждой папке лежит по три архива:  
models.bzf - модели  
textures.bzf - текстуры  
data.bzf - прочая инфа  

data.bzf  

Внутри архива data лежат следующий файлы:  
info.ini - файл с общим описанием трэка. Представляет из себя текстовый файл из строк  
VARIABLE = VALUE;  
Дробные значения указываются через точку  

Содержит следующий значения:  
NumberOfStages - целое число, общее количество этапов в трэке.  
NumberOfNoviceStages - целое число, количество этапов, начиная с первого, которые доступны на данном трэке на уровне сложности "Новичок"  
NumberOfIntermediateStages - то же самое на уровне "Любитель"  
NumberOfExpertStages - то же самое на уровне "Эксперт"  
FirstArcadeStage - целое число, индекс этапа, с которого начинаются этапы для данного трэка в режиме "Аркада"  
NumberOfArcadeStages - целое число, количество этапов для данного трэка в ружиме "Аркада"  

Далее для каждого этапа возможны следующие значения, где N - номер этапа, начиная с 1:  
StageNLength - дробное число, длина трэка в километрах. Указана при просмотре информации о этапе  
StageNTime - целое число, время старта, указаное в описании этапа. Например число 1100 будет отображено как 11:00  
StageNSurface1Type - целое число, первый тип поверхности, указанный в описании этапа. Пока что непонятно откуда берутся значения  
Stage1Surface1Amount - целое число, процент повехности первого типа от всей длины этапа.  
Stage1Surface2Type - целое число, второй тип поверхности  
Stage1Surface2Amount - целое число, процент второй поверхности  


Для каждого этапа в орхиве лежат следующие файлы:  
resetN.bin - описание точек респавна, когда мы переворачиваемся или нажимает R. Бинарный файл. Первое значени в файле - unsigned int - количество точек респавна. Каждая точка респавна занимает 72 байта. Сначала идут 16 флоатов - это таблица трансформации, которая будет применена в машине во время респавна. Сначала описывается первый столбец таблицы, затем второй и т.д. После 16 флоатов идёт какой-то флоат, который увеличивается с каждой точкой. Возможно это расстояние на трассе, которое должен проехать игрок, чтобы была выбрана именно эта точка для респавна. Последние 4 байта - unsigned int - индекс точки, начиная с 0  

